---
name: File discovery and ignore rules
status: open
created: 2026-02-17T16:35:56Z
updated: 2026-02-17T18:36:09Z
github: https://github.com/gilpaAI/ai-cartographer/issues/3
depends_on: [2]
parallel: true
conflicts_with: []
---

# Task: File discovery and ignore rules

## Description
Build the directory walker that collects all files in a repository, respecting .gitignore rules and custom ignore patterns from config. Output a flat list of file paths with basic metadata (size, extension).

## Acceptance Criteria
- [ ] Walks directory tree from project root
- [ ] Respects .gitignore patterns automatically
- [ ] Applies custom ignore patterns from cartographer config
- [ ] Default ignores: node_modules, .git, dist, build, vendor, __pycache__, *.min.js, *.map, lockfiles, binary files
- [ ] Collects file metadata: path, extension, size in bytes
- [ ] Handles symlinks gracefully (skip or follow based on config)
- [ ] Returns sorted file list for deterministic output
- [ ] Performs well on repos with 10,000+ files (<2s discovery time)

## Technical Details
- Use fast-glob or glob for directory walking
- Use ignore package to parse .gitignore rules
- Merge .gitignore + config ignore patterns
- Binary file detection via extension list + optional magic bytes check
- Output: FileEntry[] with { relativePath, extension, sizeBytes }

## Dependencies
- [ ] Task 2 (project scaffolding and config structure)

## Effort Estimate
- Size: S
- Hours: 4
- Parallel: true (can develop alongside 4 once 2 is done)

## Definition of Done
- [ ] Code implemented in src/discovery.ts
- [ ] Tests with sample directory structures
- [ ] .gitignore patterns correctly respected
- [ ] Custom ignores from config work
