---
name: Git hooks and status command
status: open
created: 2026-02-17T16:35:56Z
updated: 2026-02-17T18:36:12Z
github: https://github.com/gilpaAI/ai-cartographer/issues/9
depends_on: [8]
parallel: true
conflicts_with: []
---

# Task: Git hooks and status command

## Description
Build the git hook installer that sets up automatic map refresh on commit, and the `status` command that shows map freshness (how many commits behind, files changed since last generation).

## Acceptance Criteria
- [ ] `ai-cartographer hooks install` installs a post-commit hook
- [ ] Post-commit hook runs `ai-cartographer refresh` automatically
- [ ] Hook is non-blocking: if refresh fails, commit still succeeds
- [ ] `ai-cartographer hooks remove` cleanly removes the hook
- [ ] `ai-cartographer status` shows: last generated timestamp, commits since last generation, files changed since last generation, cache health (cached vs stale vs missing)
- [ ] Status uses git log to count commits since last generation
- [ ] Configurable: auto-commit updated map after refresh (default: no, leave as unstaged)

## Technical Details
- Hook file: .git/hooks/post-commit (append, don't overwrite existing hooks)
- Hook content: `ai-cartographer refresh --quiet 2>/dev/null || true`
- Status: read generation timestamp from context-map.md metadata, compare against git log
- Git operations via child_process.execSync (git log, git diff --name-only)

## Dependencies
- [ ] Task 8 (refresh command must exist for hooks to call)

## Effort Estimate
- Size: S
- Hours: 4
- Parallel: true (can develop alongside 10)

## Definition of Done
- [ ] Code implemented in src/commands/hooks.ts and src/commands/status.ts
- [ ] Hook installation tested in a real git repo
- [ ] Hook removal is clean (doesn't break other hooks)
- [ ] Status command shows accurate freshness info
